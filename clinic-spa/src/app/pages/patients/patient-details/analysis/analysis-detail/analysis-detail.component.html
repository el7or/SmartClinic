<form #form="ngForm" (ngSubmit)="onSave(form)" aria-labelledby="title" [nbSpinner]="formLoading"
  nbSpinnerStatus="success">
  <nb-card class="dialog-center">
    <nb-card-header>
      <!-- <b langg>New Booking for:</b> -->{{ analysisDetails }}
      <br>
      <!-- <small>
        <b langg>Last Visit Type</b>: <span langg>Diagnose</span>&nbsp;|
        <b langg>Last Visit Date</b>: 1/5/2020Ù…
      </small> -->
    </nb-card-header>
    <nb-card-body>
      <div class="row">
        <div class="col-md-6">
          <div class="form-control-group">
            <label for="input-name" class="label"><span langg>Analysis Name</span>:</label>
            <input nbInput type="text" disabled [value]="analysisDetails" id="input-name" fullWidth>
          </div>
          <div class="form-control-group">
            <label for="input-note" class="label"><span langg>Analysis Request Note</span>:</label>
            <input nbInput type="text" disabled id="input-note" fullWidth>
          </div>
          <div class="form-control-group">
            <label for="input-request" class="label"><span langg>Request Date</span>:</label>
            <input nbInput type="text" disabled value="2020-5-3" id="input-request" fullWidth>
          </div>
          <div class="form-control-group">
            <label for="input-resultDate" class="label"><span langg>Result Date</span>:</label>
            <input nbInput type="text" disabled id="input-resultDate" fullWidth>
          </div>
        </div>
        <div class="col-md-6">
          <div class="form-control-group">
            <label for="input-result" class="label"><span langg>Result</span>:</label>
            <input nbInput ngModel #result="ngModel" type="text" id="input-result" name="result"
              [placeholder]="'Register Result' | langg" fullWidth>
          </div>
          <div class="form-control-group">
            <label for="input-resultGrade" class="label"><span langg>Disease Severity</span>:</label>
            <nb-select fullWidth ngModel #resultGrade="ngModel" name="resultGrade"
              [placeholder]="'Disease Severity' | langg">
              <nb-option value="0">Grade 0</nb-option>
              <nb-option value="1">Grade 1</nb-option>
              <nb-option value="2">Grade 2</nb-option>
              <nb-option value="3">Grade 3</nb-option>
              <nb-option value="4">Grade 4</nb-option>
            </nb-select>
          </div>
          <div class="form-control-group">
            <label for="input-file" class="label"><span langg>Analysis File</span>:</label>
            <input nbInput type="file" #analysisFile name="reportFile" ng2FileSelect [uploader]="uploader" id="input-file"
              fieldSize="small" fullWidth />

            <div *ngFor="let item of uploader.queue" class="row m-0">
              <ng-container *ngIf="!item.isSuccess && !item.isError">
                <div *ngIf="uploader.options.isHTML5" class="progress col-12 my-1">
                  <div class="progress-bar" role="progressbar" [ngStyle]="{ 'width': item.progress + '%' }"></div>
                </div>
                <div *ngIf="uploader.options.isHTML5" class="col-6">
                  <span langg>File size:</span> {{ item?.file?.size/1024/1024 | number:'.0-2' }} MB
                </div>
                <div class="col-6">
                  <button nbButton type="button" (click)="item.upload()"
                    [disabled]="item.isReady || item.isUploading || item.isSuccess" status="success" size="tiny">
                    <nb-icon icon="cloud-upload-outline"></nb-icon><span langg>Upload</span>
                  </button>&nbsp;
                  <button nbButton type="button" (click)="item.remove();analysisFile.value=null" status="danger"
                    size="tiny">
                    <nb-icon icon="trash-2-outline"></nb-icon><span langg>Remove</span>
                  </button>
                </div>
              </ng-container>
              <div class="col-12 text-center">
                <div *ngIf="item.isSuccess || item.isError" class="alert alert-success mb-1" role="alert">
                  <span langg>Upload successful</span>&nbsp;
                  <nb-icon icon="done-all-outline"></nb-icon>
                </div>
                <!-- <div *ngIf="item.isSuccess" class="alert alert-success" role="alert">
                  <span langg>Upload successful</span>&nbsp;
                  <nb-icon icon="done-all-outline"></nb-icon>
                </div>
                <div *ngIf="item.isError" class="alert alert-danger" role="alert">
                  <span langg>Upload failed</span>&nbsp;
                  <nb-icon icon="alert-triangle-outline"></nb-icon>
                </div> -->
              </div>
              <div *ngIf="item.isSuccess || item.isError" class="col-12">
                <a nbButton href="../../../../../../assets/images/team.png" target="_blank" status="info" size="small"
                  langg>Preview</a>&nbsp;
                <a nbButton href="../../../../../../assets/images/team.png" download="analysis_report" size="small"
                  langg>Download</a>&nbsp;
                <button nbButton type="button" (click)="item.remove();analysisFile.value=null" status="danger"
                  size="small" langg>Delete</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </nb-card-body>
    <nb-card-footer>
      <div class="text-center nbButton-group">
        <button nbButton type="submit" status="success" [disabled]="!form.valid || (uploader.queue.length >0 && !uploader?.queue[0]?.isSuccess && !uploader?.queue[0]?.isError)" langg>Save</button>
        <button nbButton type="button" status="danger" langg (click)="dialogRef.close()">Cancel</button></div>
    </nb-card-footer>
  </nb-card>
</form>

<swal #doneSwal [title]="'Success' | langg" [text]="'Done successfully!' | langg" icon="success" timer="2000"
  [showConfirmButton]="false">
</swal>
