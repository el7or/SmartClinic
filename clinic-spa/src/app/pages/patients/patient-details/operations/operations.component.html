<h6>{{'Add New Operation:' | langg}}</h6>
<form #form="ngForm" (ngSubmit)="onSave(form)" aria-labelledby="title" [nbSpinner]="formLoading"
  nbSpinnerStatus="success">
  <div class="row">
    <div class="col-md-3 col-sm-6 form-control-group">
      <label for="input-type" class="label"><span>{{'Operation Type' | langg}}</span>:</label>
      <nb-select fullWidth [ngModel]="operation?.typeId" #type="ngModel" name="type" [placeholder]="'' | langg" required>
        <nb-option *ngFor="let item of operationTypeValues" [value]="item.id" langg>{{item.text}}</nb-option>
      </nb-select>
    </div>
    <div class="col-md-3 col-sm-6 form-control-group">
      <label for="input-date" class="label"><span>{{'Operation Date' | langg}}</span>:</label>
      <input type="text" bsDatepicker nbInput [ngModel]="operation?.date" #date="ngModel" name="date" id="input-date" fullWidth readonly
        [bsConfig]="{ adaptivePosition: true, containerClass: 'theme-dark-blue', showWeekNumbers: false }">
    </div>
    <div class="col-md-3 col-sm-6 form-control-group">
      <label for="input-place" class="label"><span>{{'Operation Place' | langg}}</span>:</label>
      <input nbInput [ngModel]="operation?.place" type="text" #place="ngModel" name="place" id="input-place" fullWidth>
    </div>
    <div class="col-md-3 col-sm-6 form-control-group">
      <label for="input-cost" class="label"><span>{{'Operation Cost' | langg}}</span>:</label>
      <input nbInput [ngModel]="operation?.cost" type="number" #cost="ngModel" name="cost" id="input-cost" fullWidth>
    </div>
    <div class="col-12 form-control-group">
      <textarea nbInput [ngModel]="operation?.note" #note="ngModel" name="note" [placeholder]="'General notes on Operation' | langg"
        fullWidth></textarea>
    </div>
  </div>

  <div class="text-center nbButton-group">
    <button nbButton type="submit" status="success" [disabled]="!form.valid || !form.dirty">{{'Save' | langg}}</button>
    <button nbButton type="button" status="danger" (click)="location.back()">{{'Cancel' | langg}}</button>
  </div>
</form>
<hr>
<h6>{{'Past Operations:' | langg}}</h6>
<table class="table table-bordered">
  <thead class="thead-light">
    <tr>
      <th>{{'Operation Date' | langg}}</th>
      <th>{{'Operation Type' | langg}}</th>
      <th>{{'Operation Place' | langg}}</th>
      <th>{{'Operation Cost' | langg}}</th>
      <th>{{'Note' | langg}}</th>
      <th></th>
    </tr>
  </thead>
  <tbody *ngIf="!prevPatientOperations?.length">
    <tr>
      <td colspan="6" class="text-center">
        <h5>{{'No Results !' | langg}}</h5>
      </td>
    </tr>
  </tbody>
  <tbody *ngIf="prevPatientOperations?.length">
    <tr *ngFor="let item of prevPatientOperations; index as i">
      <td>{{item.date | localDateShort}}</td>
      <td>{{item.type}}</td>
      <td>{{item.place}}</td>
      <td>{{item.cost}} {{'EGP' | langg}}</td>
      <td>{{item.note}}</td>
      <td class="text-center">
        <button nbButton type="button" (click)="onEditOperation(item)" status="warning" size="small">{{'Edit' | langg}}</button>&nbsp;
        <button nbButton type="button" (click)="onDeleteOperation(item.id,i)" status="danger" size="small">{{'Delete' | langg}}</button>
      </td>
    </tr>
  </tbody>
</table>

<swal #doneSwal [title]="'Success' | langg" [text]="'Done successfully!' | langg" icon="success" timer="2000"
  [showConfirmButton]="false">
</swal>

<swal #deleteSwal icon="error" showCancelButton="true" focusCancel="true" [title]="'Attention !' | langg"
  [text]="'This data will be deleted forever and all other data related to it, and it will not be retrievable again!' | langg"
  [confirmButtonText]="'Delete' | langg" [cancelButtonText]="'Cancel' | langg" confirmButtonColor="#ff3d71">
</swal>
